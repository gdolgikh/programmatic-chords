---
import Header from './Header.astro';
import Footer from './Footer.astro';
import CookieConsent from './CookieConsent.astro';
import { ViewTransitions } from 'astro:transitions';
const { title = 'Chord Library - Learn Guitar Chords', description = 'Free guitar chord library with 192 chords across all 12 keys. Interactive diagrams, finger placement guides, audio playback, and a progression generator to help you write songs.', keywords = '' } = Astro.props;
---

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{title}</title>
  <meta name="description" content={description} />
  {keywords && <meta name="keywords" content={keywords} />}
  <style>
    /* Self-hosted fonts â€” latin only */
    @font-face {
      font-family: 'Playfair Display';
      font-style: normal;
      font-weight: 400 900;
      font-display: swap;
      src: url('/fonts/playfair-display-latin.woff2') format('woff2');
    }
    @font-face {
      font-family: 'Playfair Display';
      font-style: italic;
      font-weight: 400 700;
      font-display: swap;
      src: url('/fonts/playfair-display-italic-latin.woff2') format('woff2');
    }
    @font-face {
      font-family: 'IBM Plex Sans';
      font-style: normal;
      font-weight: 300 700;
      font-display: swap;
      src: url('/fonts/ibm-plex-sans-latin.woff2') format('woff2');
    }
    @font-face {
      font-family: 'IBM Plex Mono';
      font-style: normal;
      font-weight: 400;
      font-display: swap;
      src: url('/fonts/ibm-plex-mono-400-latin.woff2') format('woff2');
    }
    @font-face {
      font-family: 'IBM Plex Mono';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url('/fonts/ibm-plex-mono-500-latin.woff2') format('woff2');
    }
  </style>
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'><text y='28' font-size='28'>ðŸŽ¸</text></svg>" />
  <ViewTransitions />
  <script is:inline>
    (function() {
      var t = localStorage.getItem('theme');
      if (t === 'dark') document.documentElement.classList.add('dark');
    })();
  </script>
  <script is:inline>
    (function() {
      function loadAnalytics() {
        if (document.getElementById('ahrefs-analytics')) return;
        var s = document.createElement('script');
        s.id = 'ahrefs-analytics';
        s.src = 'https://analytics.ahrefs.com/analytics.js';
        s.dataset.key = 'gp+f+eFsakb1xf/+OqLWIg';
        s.async = true;
        document.head.appendChild(s);
      }
      if (localStorage.getItem('cookie_consent') === 'accepted') {
        loadAnalytics();
      }
      window.__loadAnalytics = loadAnalytics;
    })();
  </script>
  <script is:inline>
    document.addEventListener('astro:before-swap', function(e) {
      var isDark = document.documentElement.classList.contains('dark');
      if (isDark) e.newDocument.documentElement.classList.add('dark');
    });
  </script>
</head>
<body>
  <Header />
  <main>
    <slot />
  </main>
  <Footer />
  <CookieConsent />
</body>
</html>

<style is:global>
  :root {
    --cream: #f5f0e8;
    --paper: #ede8dc;
    --ink: #1a1510;
    --ink-faded: #5a4f3f;
    --red: #c0392b;
    --rule: #c8bfa8;
    --rule-bright: #c8bfa8;
    --card-bg: #f5f0e8;
    --card-hover: #ede8dc;

    /* Diagram-specific */
    --diagram-line: #1a1510;
    --diagram-nut: #1a1510;
    --diagram-dot: #1a1510;
    --diagram-dot-text: #f5f0e8;
    --diagram-open: #1a1510;
    --diagram-mute: #5a4f3f;
  }

  html.dark {
    --cream: #0e0d0b;
    --paper: #161410;
    --ink: #c8b98a;
    --ink-faded: #6b5e42;
    --red: #d4a843;
    --rule: #2e2a22;
    --rule-bright: #3d3830;
    --card-bg: #1c1a16;
    --card-hover: #221f1a;

    --diagram-line: #3d3830;
    --diagram-nut: #c8b98a;
    --diagram-dot: #c8b98a;
    --diagram-dot-text: #0e0d0b;
    --diagram-open: #c8b98a;
    --diagram-mute: #6b5e42;
  }

  *, *::before, *::after {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }

  html {
    scroll-behavior: smooth;
  }

  body {
    font-family: 'IBM Plex Sans', system-ui, -apple-system, sans-serif;
    background: var(--cream);
    color: var(--ink);
    min-height: 100vh;
    overflow-x: hidden;
    -webkit-font-smoothing: antialiased;
    transition: background 0.3s ease, color 0.3s ease;
  }

  /* Grain texture overlay â€” hidden on mobile for performance */
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.04'/%3E%3C/svg%3E");
    pointer-events: none;
    z-index: 1000;
    opacity: 0.6;
  }

  @media (max-width: 768px) {
    body::before {
      display: none;
    }
  }

  main {
    max-width: 1100px;
    margin: 0 auto;
    padding: 0 24px 3rem;
  }

  /* Editorial card utility */
  .glass {
    background: var(--card-bg);
    border: 1px solid var(--rule);
    border-radius: 0;
    transition: background 0.2s ease;
  }

  .glass:hover {
    background: var(--card-hover);
  }

  a {
    color: inherit;
    text-decoration: none;
  }
</style>
